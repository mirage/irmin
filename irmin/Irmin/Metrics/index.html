<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Metrics (irmin.Irmin.Metrics)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">irmin</a> &#x00BB; <a href="../index.html">Irmin</a> &#x00BB; Metrics</nav><header class="odoc-preamble"><h1>Module <code><span>Irmin.Metrics</span></code></h1><p>Type agnostics mechanisms to manipulate metrics.</p><p><code>Metrics</code> defines primitives to handle metrics inside of Irmin. Its purpose is to decouple the metrics type definition from the data manipulation.</p><p>A <a href="#type-t"><code>t</code></a> can be modified in different ways, depending on the <a href="#type-update_mode"><code>update_mode</code></a>.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-origin"><a href="#type-origin" class="anchor"></a><code><span><span class="keyword">type</span> origin</span><span> = </span><span>..</span></code></div><div class="spec-doc"><p>An extensible type to get the location of the definition.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p><a href="#type-t"><code>t</code></a> is the object that describes how a <a href="#type-t"><code>t</code></a> is gathered and store. The <code>'a</code> parameter represents the type of the internal data.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-state"><a href="#val-state" class="anchor"></a><code><span><span class="keyword">val</span> state : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>The internal state extracted from a <a href="#type-t"><code>t</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_state"><a href="#val-set_state" class="anchor"></a><code><span><span class="keyword">val</span> set_state : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set_state m v</code> updates the value in the <a href="#type-t"><code>t</code></a> object.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-update_mode"><a href="#type-update_mode" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a update_mode</span></span><span> = </span></code><ol><li id="type-update_mode.Mutate" class="def variant constructor anchored"><a href="#type-update_mode.Mutate" class="anchor"></a><code><span>| </span><span><span class="constructor">Mutate</span> <span class="keyword">of</span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></li><li id="type-update_mode.Replace" class="def variant constructor anchored"><a href="#type-update_mode.Replace" class="anchor"></a><code><span>| </span><span><span class="constructor">Replace</span> <span class="keyword">of</span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></li></ol></div><div class="spec-doc"><p><a href="#type-update_mode"><code>update_mode</code></a> describes how the data will be handled by the <a href="#val-update"><code>update</code></a> function.</p><ul><li>Mutate: the value and the storage are not modified but the content of the value can be mutate.</li><li>Replace f: apply f to the value and updates its content.</li></ul><p>It gives the possibility to handle the same metric in different ways.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-v"><a href="#val-v" class="anchor"></a><code><span><span class="keyword">val</span> v : <span><span class="optlabel">?origin</span>:<a href="#type-origin">origin</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">initial_state</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Repr</span>.ty</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>v ~origin ~name ~initial_state  repr </code> create a new <a href="#type-t"><code>t</code></a>. The <code>origin</code> can be set to give an hint about where the data are gathered. <code>name</code> is a name to describe this metrics. <code>initial_state</code> is the first value to store in the metric object. <code>repr</code> describes the type representation to allow serialization.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update"><a href="#val-update" class="anchor"></a><code><span><span class="keyword">val</span> update : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-update_mode">update_mode</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>update metrics mode</code> updates the metric by taking in consideration <code>mode</code> to define how it acts on <code>t</code> according to their specication.</p></div></div></div></body></html>
