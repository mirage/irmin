<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Head (irmin-mirage-git.Irmin_mirage_git.KV_maker.Make.Head)</title><link rel="stylesheet" href="../../../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">irmin-mirage-git</a> &#x00BB; <a href="../../../index.html">Irmin_mirage_git</a> &#x00BB; <a href="../../index.html">KV_maker</a> &#x00BB; <a href="../index.html">Make</a> &#x00BB; Head</nav><header class="odoc-preamble"><h1>Module <code><span>Make.Head</span></code></h1><p>Managing the store's heads.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-list"><a href="#val-list" class="anchor"></a><code><span><span class="keyword">val</span> list : <span><a href="../index.html#type-repo">repo</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../index.html#type-commit">commit</a> list</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>list t</code> is the list of all the heads in local store. Similar to <code>git rev-list --all</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find"><a href="#val-find" class="anchor"></a><code><span><span class="keyword">val</span> find : <span><a href="../index.html#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../index.html#type-commit">commit</a> option</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>find t</code> is the current head of the store <code>t</code>. This works for both persistent and temporary branches. In the case of a persistent branch, this involves getting the the head associated with the branch, so this may block. In the case of a temporary store, it simply returns the current head. Returns <code>None</code> if the store has no contents. Similar to <code>git rev-parse HEAD</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><a href="../index.html#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-commit">commit</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Same as <a href="#val-find"><code>find</code></a> but raise <code>Invalid_argument</code> if the store does not have any contents.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span><a href="../index.html#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-commit">commit</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>set t h</code> updates <code>t</code>'s contents with the contents of the commit <code>h</code>. Can cause data loss as it discards the current contents. Similar to <code>git reset --hard &lt;hash&gt;</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fast_forward"><a href="#val-fast_forward" class="anchor"></a><code><span><span class="keyword">val</span> fast_forward : 
  <span><a href="../index.html#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?max_depth:int <span class="arrow">&#45;&gt;</span></span>
  <span>?n:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../index.html#type-commit">commit</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <a href="../index.html#type-ff_error">ff_error</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>fast_forward t h</code> is similar to <a href="#val-set"><code>set</code></a> but the <code>t</code>'s head is updated to <code>h</code> only if <code>h</code> is stricly in the future of <code>t</code>'s current head. <code>max_depth</code> or <code>n</code> are used to limit the search space of the lowest common ancestors (see <a href="../index.html#val-lcas"><code>lcas</code></a>).</p><p>The result is:</p><ul><li><code>Ok ()</code> if the operation is succesfull;</li><li><code>Error `No_change</code> if <code>h</code> is already <code>t</code>'s head;</li><li><code>Error `Rejected</code> if <code>h</code> is not in the strict future of <code>t</code>'s head.</li><li><code>Error e</code> if the history exploration has been cut before getting useful results. In that case. the operation can be retried using different parameters of <code>n</code> and <code>max_depth</code> to get better results.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-test_and_set"><a href="#val-test_and_set" class="anchor"></a><code><span><span class="keyword">val</span> test_and_set : <span><a href="../index.html#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>test:<span><a href="../index.html#type-commit">commit</a> option</span> <span class="arrow">&#45;&gt;</span></span> <span>set:<span><a href="../index.html#type-commit">commit</a> option</span> <span class="arrow">&#45;&gt;</span></span> <span>bool <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Same as <a href="#val-set"><code>set</code></a> but check that the value is <code>test</code> before updating to <code>set</code>. Use <a href="#val-set"><code>set</code></a> or <a href="#val-merge"><code>merge</code></a> instead if possible.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-merge"><a href="#val-merge" class="anchor"></a><code><span><span class="keyword">val</span> merge : 
  <span>into:<a href="../index.html#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>info:<a href="../Info/index.html#type-f">Info.f</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?max_depth:int <span class="arrow">&#45;&gt;</span></span>
  <span>?n:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../index.html#type-commit">commit</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <a href="../../../../../irmin/Irmin/Merge/index.html#type-conflict">Irmin.Merge.conflict</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>merge ~into:t ?max_head ?n commit</code> merges the contents of the commit associated to <code>commit</code> into <code>t</code>. <code>max_depth</code> is the maximal depth used for getting the lowest common ancestor. <code>n</code> is the maximum number of lowest common ancestors. If present, <code>max_depth</code> or <code>n</code> are used to limit the search space of the lowest common ancestors (see <a href="../index.html#val-lcas"><code>lcas</code></a>).</p></div></div></div></body></html>