<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>V0 (irmin-bench.Irmin_traces.Trace_definitions.Stat_trace.V0)</title><link rel="stylesheet" href="../../../../../_odoc_support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../_odoc_support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">irmin-bench</a> &#x00BB; <a href="../../../index.html">Irmin_traces</a> &#x00BB; <a href="../../index.html">Trace_definitions</a> &#x00BB; <a href="../index.html">Stat_trace</a> &#x00BB; V0</nav><header class="odoc-preamble"><h1>Module <code><span>Stat_trace.V0</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-version"><a href="#val-version" class="anchor"></a><code><span><span class="keyword">val</span> version : int</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-float32"><a href="#type-float32" class="anchor"></a><code><span><span class="keyword">type</span> float32</span><span> = int32</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-float32_t"><a href="#val-float32_t" class="anchor"></a><code><span><span class="keyword">val</span> float32_t : <span>int32 <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-pack"><a href="#type-pack" class="anchor"></a><code><span><span class="keyword">type</span> pack</span><span> = </span><span>{</span></code><ol><li id="type-pack.finds" class="def record field anchored"><a href="#type-pack.finds" class="anchor"></a><code><span>finds : int;</span></code></li><li id="type-pack.cache_misses" class="def record field anchored"><a href="#type-pack.cache_misses" class="anchor"></a><code><span>cache_misses : int;</span></code></li><li id="type-pack.appended_hashes" class="def record field anchored"><a href="#type-pack.appended_hashes" class="anchor"></a><code><span>appended_hashes : int;</span></code></li><li id="type-pack.appended_offsets" class="def record field anchored"><a href="#type-pack.appended_offsets" class="anchor"></a><code><span>appended_offsets : int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Stats extracted from <code>Irmin_pack.Stats.get ()</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pack_t"><a href="#val-pack_t" class="anchor"></a><code><span><span class="keyword">val</span> pack_t : <span><a href="#type-pack">pack</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tree"><a href="#type-tree" class="anchor"></a><code><span><span class="keyword">type</span> tree</span><span> = </span><span>{</span></code><ol><li id="type-tree.contents_hash" class="def record field anchored"><a href="#type-tree.contents_hash" class="anchor"></a><code><span>contents_hash : int;</span></code></li><li id="type-tree.contents_find" class="def record field anchored"><a href="#type-tree.contents_find" class="anchor"></a><code><span>contents_find : int;</span></code></li><li id="type-tree.contents_add" class="def record field anchored"><a href="#type-tree.contents_add" class="anchor"></a><code><span>contents_add : int;</span></code></li><li id="type-tree.node_hash" class="def record field anchored"><a href="#type-tree.node_hash" class="anchor"></a><code><span>node_hash : int;</span></code></li><li id="type-tree.node_mem" class="def record field anchored"><a href="#type-tree.node_mem" class="anchor"></a><code><span>node_mem : int;</span></code></li><li id="type-tree.node_add" class="def record field anchored"><a href="#type-tree.node_add" class="anchor"></a><code><span>node_add : int;</span></code></li><li id="type-tree.node_find" class="def record field anchored"><a href="#type-tree.node_find" class="anchor"></a><code><span>node_find : int;</span></code></li><li id="type-tree.node_val_v" class="def record field anchored"><a href="#type-tree.node_val_v" class="anchor"></a><code><span>node_val_v : int;</span></code></li><li id="type-tree.node_val_find" class="def record field anchored"><a href="#type-tree.node_val_find" class="anchor"></a><code><span>node_val_find : int;</span></code></li><li id="type-tree.node_val_list" class="def record field anchored"><a href="#type-tree.node_val_list" class="anchor"></a><code><span>node_val_list : int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Stats extracted from <code>Irmin.Tree.counters ()</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tree_t"><a href="#val-tree_t" class="anchor"></a><code><span><span class="keyword">val</span> tree_t : <span><a href="#type-tree">tree</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-index"><a href="#type-index" class="anchor"></a><code><span><span class="keyword">type</span> index</span><span> = </span><span>{</span></code><ol><li id="type-index.bytes_read" class="def record field anchored"><a href="#type-index.bytes_read" class="anchor"></a><code><span>bytes_read : int;</span></code></li><li id="type-index.nb_reads" class="def record field anchored"><a href="#type-index.nb_reads" class="anchor"></a><code><span>nb_reads : int;</span></code></li><li id="type-index.bytes_written" class="def record field anchored"><a href="#type-index.bytes_written" class="anchor"></a><code><span>bytes_written : int;</span></code></li><li id="type-index.nb_writes" class="def record field anchored"><a href="#type-index.nb_writes" class="anchor"></a><code><span>nb_writes : int;</span></code></li><li id="type-index.nb_merge" class="def record field anchored"><a href="#type-index.nb_merge" class="anchor"></a><code><span>nb_merge : int;</span></code></li><li id="type-index.new_merge_durations" class="def record field anchored"><a href="#type-index.new_merge_durations" class="anchor"></a><code><span>new_merge_durations : <span>float list</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Stats extracted from <code>Index.Stats.get ()</code>.</p><p><code>new_merge_durations</code> is not just a mirror of <code>Index.Stats.merge_durations</code>, it only contains the new entries since the last time it was recorded. This list is always empty when in the header.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-index_t"><a href="#val-index_t" class="anchor"></a><code><span><span class="keyword">val</span> index_t : <span><a href="#type-index">index</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-gc"><a href="#type-gc" class="anchor"></a><code><span><span class="keyword">type</span> gc</span><span> = </span><span>{</span></code><ol><li id="type-gc.minor_words" class="def record field anchored"><a href="#type-gc.minor_words" class="anchor"></a><code><span>minor_words : float;</span></code></li><li id="type-gc.promoted_words" class="def record field anchored"><a href="#type-gc.promoted_words" class="anchor"></a><code><span>promoted_words : float;</span></code></li><li id="type-gc.major_words" class="def record field anchored"><a href="#type-gc.major_words" class="anchor"></a><code><span>major_words : float;</span></code></li><li id="type-gc.minor_collections" class="def record field anchored"><a href="#type-gc.minor_collections" class="anchor"></a><code><span>minor_collections : int;</span></code></li><li id="type-gc.major_collections" class="def record field anchored"><a href="#type-gc.major_collections" class="anchor"></a><code><span>major_collections : int;</span></code></li><li id="type-gc.heap_words" class="def record field anchored"><a href="#type-gc.heap_words" class="anchor"></a><code><span>heap_words : int;</span></code></li><li id="type-gc.compactions" class="def record field anchored"><a href="#type-gc.compactions" class="anchor"></a><code><span>compactions : int;</span></code></li><li id="type-gc.top_heap_words" class="def record field anchored"><a href="#type-gc.top_heap_words" class="anchor"></a><code><span>top_heap_words : int;</span></code></li><li id="type-gc.stack_size" class="def record field anchored"><a href="#type-gc.stack_size" class="anchor"></a><code><span>stack_size : int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Stats extracted from <code>Gc.quick_stat ()</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gc_t"><a href="#val-gc_t" class="anchor"></a><code><span><span class="keyword">val</span> gc_t : <span><a href="#type-gc">gc</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-disk"><a href="#type-disk" class="anchor"></a><code><span><span class="keyword">type</span> disk</span><span> = </span><span>{</span></code><ol><li id="type-disk.index_data" class="def record field anchored"><a href="#type-disk.index_data" class="anchor"></a><code><span>index_data : int64;</span></code></li><li id="type-disk.index_log" class="def record field anchored"><a href="#type-disk.index_log" class="anchor"></a><code><span>index_log : int64;</span></code></li><li id="type-disk.index_log_async" class="def record field anchored"><a href="#type-disk.index_log_async" class="anchor"></a><code><span>index_log_async : int64;</span></code></li><li id="type-disk.store_dict" class="def record field anchored"><a href="#type-disk.store_dict" class="anchor"></a><code><span>store_dict : int64;</span></code></li><li id="type-disk.store_pack" class="def record field anchored"><a href="#type-disk.store_pack" class="anchor"></a><code><span>store_pack : int64;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Stats extracted from filesystem. Requires the path to the irmin store.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-disk_t"><a href="#val-disk_t" class="anchor"></a><code><span><span class="keyword">val</span> disk_t : <span><a href="#type-disk">disk</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-bag_of_stats_base"><a href="#type-bag_of_stats_base" class="anchor"></a><code><span><span class="keyword">type</span> <span>'pack_stats bag_of_stats_base</span></span><span> = </span><span>{</span></code><ol><li id="type-bag_of_stats_base.pack" class="def record field anchored"><a href="#type-bag_of_stats_base.pack" class="anchor"></a><code><span>pack : <span class="type-var">'pack_stats</span>;</span></code></li><li id="type-bag_of_stats_base.tree" class="def record field anchored"><a href="#type-bag_of_stats_base.tree" class="anchor"></a><code><span>tree : <a href="#type-tree">tree</a>;</span></code></li><li id="type-bag_of_stats_base.index" class="def record field anchored"><a href="#type-bag_of_stats_base.index" class="anchor"></a><code><span>index : <a href="#type-index">index</a>;</span></code></li><li id="type-bag_of_stats_base.gc" class="def record field anchored"><a href="#type-bag_of_stats_base.gc" class="anchor"></a><code><span>gc : <a href="#type-gc">gc</a>;</span></code></li><li id="type-bag_of_stats_base.disk" class="def record field anchored"><a href="#type-bag_of_stats_base.disk" class="anchor"></a><code><span>disk : <a href="#type-disk">disk</a>;</span></code></li><li id="type-bag_of_stats_base.timestamp_wall" class="def record field anchored"><a href="#type-bag_of_stats_base.timestamp_wall" class="anchor"></a><code><span>timestamp_wall : float;</span></code></li><li id="type-bag_of_stats_base.timestamp_cpu" class="def record field anchored"><a href="#type-bag_of_stats_base.timestamp_cpu" class="anchor"></a><code><span>timestamp_cpu : float;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Melting pot of stats, recorded before and after every commits.</p><p>They are necessary in order to compute any throughput analytics.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bag_of_stats_base_t"><a href="#val-bag_of_stats_base_t" class="anchor"></a><code><span><span class="keyword">val</span> bag_of_stats_base_t : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Repr</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-bag_of_stats_base">bag_of_stats_base</a></span> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-store_before"><a href="#type-store_before" class="anchor"></a><code><span><span class="keyword">type</span> store_before</span><span> = </span><span>{</span></code><ol><li id="type-store_before.nodes" class="def record field anchored"><a href="#type-store_before.nodes" class="anchor"></a><code><span>nodes : int;</span></code></li><li id="type-store_before.leafs" class="def record field anchored"><a href="#type-store_before.leafs" class="anchor"></a><code><span>leafs : int;</span></code></li><li id="type-store_before.skips" class="def record field anchored"><a href="#type-store_before.skips" class="anchor"></a><code><span>skips : int;</span></code></li><li id="type-store_before.depth" class="def record field anchored"><a href="#type-store_before.depth" class="anchor"></a><code><span>depth : int;</span></code></li><li id="type-store_before.width" class="def record field anchored"><a href="#type-store_before.width" class="anchor"></a><code><span>width : int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Stats computed from the <code>tree</code> value passed to the commit operation, before the commit, when the tree still carries the modifications brought by the previous operations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-store_before_t"><a href="#val-store_before_t" class="anchor"></a><code><span><span class="keyword">val</span> store_before_t : <span><a href="#type-store_before">store_before</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-watched_node"><a href="#type-watched_node" class="anchor"></a><code><span><span class="keyword">type</span> watched_node</span><span> = </span><span>[ </span></code><ol><li id="type-watched_node.Contracts_index" class="def constructor anchored"><a href="#type-watched_node.Contracts_index" class="anchor"></a><code><span>| </span></code><code><span>`Contracts_index</span></code></li><li id="type-watched_node.Big_maps_index" class="def constructor anchored"><a href="#type-watched_node.Big_maps_index" class="anchor"></a><code><span>| </span></code><code><span>`Big_maps_index</span></code></li><li id="type-watched_node.Rolls_index" class="def constructor anchored"><a href="#type-watched_node.Rolls_index" class="anchor"></a><code><span>| </span></code><code><span>`Rolls_index</span></code></li><li id="type-watched_node.Rolls_owner_current" class="def constructor anchored"><a href="#type-watched_node.Rolls_owner_current" class="anchor"></a><code><span>| </span></code><code><span>`Rolls_owner_current</span></code></li><li id="type-watched_node.Commitments" class="def constructor anchored"><a href="#type-watched_node.Commitments" class="anchor"></a><code><span>| </span></code><code><span>`Commitments</span></code></li><li id="type-watched_node.Contracts_index_ed25519" class="def constructor anchored"><a href="#type-watched_node.Contracts_index_ed25519" class="anchor"></a><code><span>| </span></code><code><span>`Contracts_index_ed25519</span></code></li><li id="type-watched_node.Contracts_index_originated" class="def constructor anchored"><a href="#type-watched_node.Contracts_index_originated" class="anchor"></a><code><span>| </span></code><code><span>`Contracts_index_originated</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-min_watched_node"><a href="#val-min_watched_node" class="anchor"></a><code><span><span class="keyword">val</span> min_watched_node : int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-max_watched_node"><a href="#val-max_watched_node" class="anchor"></a><code><span><span class="keyword">val</span> max_watched_node : int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-watched_node_to_enum"><a href="#val-watched_node_to_enum" class="anchor"></a><code><span><span class="keyword">val</span> watched_node_to_enum : 
  <span><span>[&lt; `Big_maps_index
  <span>| `Commitments</span>
  <span>| `Contracts_index</span>
  <span>| `Contracts_index_ed25519</span>
  <span>| `Contracts_index_originated</span>
  <span>| `Rolls_index</span>
  <span>| `Rolls_owner_current</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-watched_node_of_enum"><a href="#val-watched_node_of_enum" class="anchor"></a><code><span><span class="keyword">val</span> watched_node_of_enum : 
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&gt; `Big_maps_index
  <span>| `Commitments</span>
  <span>| `Contracts_index</span>
  <span>| `Contracts_index_ed25519</span>
  <span>| `Contracts_index_originated</span>
  <span>| `Rolls_index</span>
  <span>| `Rolls_owner_current</span> ]</span>
    option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-watched_node_t"><a href="#val-watched_node_t" class="anchor"></a><code><span><span class="keyword">val</span> watched_node_t : 
  <span><span>[ `Big_maps_index
  <span>| `Commitments</span>
  <span>| `Contracts_index</span>
  <span>| `Contracts_index_ed25519</span>
  <span>| `Contracts_index_originated</span>
  <span>| `Rolls_index</span>
  <span>| `Rolls_owner_current</span> ]</span>
    <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-store_after"><a href="#type-store_after" class="anchor"></a><code><span><span class="keyword">type</span> store_after</span><span> = </span><span>{</span></code><ol><li id="type-store_after.watched_nodes_length" class="def record field anchored"><a href="#type-store_after.watched_nodes_length" class="anchor"></a><code><span>watched_nodes_length : <span>int list</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Stats computed on the <code>tree</code> value passed to the commit operation, after the commit, when the inode has been reconstructed and that <code>Tree.length</code> is now innexpensive to perform.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-store_after_t"><a href="#val-store_after_t" class="anchor"></a><code><span><span class="keyword">val</span> store_after_t : <span><a href="#type-store_after">store_after</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-commit_base"><a href="#type-commit_base" class="anchor"></a><code><span><span class="keyword">type</span> <span>'pack_stats commit_base</span></span><span> = </span><span>{</span></code><ol><li id="type-commit_base.duration" class="def record field anchored"><a href="#type-commit_base.duration" class="anchor"></a><code><span>duration : <a href="#type-float32">float32</a>;</span></code></li><li id="type-commit_base.before" class="def record field anchored"><a href="#type-commit_base.before" class="anchor"></a><code><span>before : <span><span class="type-var">'pack_stats</span> <a href="#type-bag_of_stats_base">bag_of_stats_base</a></span>;</span></code></li><li id="type-commit_base.after" class="def record field anchored"><a href="#type-commit_base.after" class="anchor"></a><code><span>after : <span><span class="type-var">'pack_stats</span> <a href="#type-bag_of_stats_base">bag_of_stats_base</a></span>;</span></code></li><li id="type-commit_base.store_before" class="def record field anchored"><a href="#type-commit_base.store_before" class="anchor"></a><code><span>store_before : <a href="#type-store_before">store_before</a>;</span></code></li><li id="type-commit_base.store_after" class="def record field anchored"><a href="#type-commit_base.store_after" class="anchor"></a><code><span>store_after : <a href="#type-store_after">store_after</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-commit_base_t"><a href="#val-commit_base_t" class="anchor"></a><code><span><span class="keyword">val</span> commit_base_t : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Repr</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-commit_base">commit_base</a></span> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-row_base"><a href="#type-row_base" class="anchor"></a><code><span><span class="keyword">type</span> <span>'pack_stats row_base</span></span><span> = </span><span>[ </span></code><ol><li id="type-row_base.Add" class="def constructor anchored"><a href="#type-row_base.Add" class="anchor"></a><code><span>| </span></code><code><span>`Add <span class="keyword">of</span> <a href="#type-float32">float32</a></span></code></li><li id="type-row_base.Remove" class="def constructor anchored"><a href="#type-row_base.Remove" class="anchor"></a><code><span>| </span></code><code><span>`Remove <span class="keyword">of</span> <a href="#type-float32">float32</a></span></code></li><li id="type-row_base.Find" class="def constructor anchored"><a href="#type-row_base.Find" class="anchor"></a><code><span>| </span></code><code><span>`Find <span class="keyword">of</span> <a href="#type-float32">float32</a></span></code></li><li id="type-row_base.Mem" class="def constructor anchored"><a href="#type-row_base.Mem" class="anchor"></a><code><span>| </span></code><code><span>`Mem <span class="keyword">of</span> <a href="#type-float32">float32</a></span></code></li><li id="type-row_base.Mem_tree" class="def constructor anchored"><a href="#type-row_base.Mem_tree" class="anchor"></a><code><span>| </span></code><code><span>`Mem_tree <span class="keyword">of</span> <a href="#type-float32">float32</a></span></code></li><li id="type-row_base.Checkout" class="def constructor anchored"><a href="#type-row_base.Checkout" class="anchor"></a><code><span>| </span></code><code><span>`Checkout <span class="keyword">of</span> <a href="#type-float32">float32</a></span></code></li><li id="type-row_base.Copy" class="def constructor anchored"><a href="#type-row_base.Copy" class="anchor"></a><code><span>| </span></code><code><span>`Copy <span class="keyword">of</span> <a href="#type-float32">float32</a></span></code></li><li id="type-row_base.Commit" class="def constructor anchored"><a href="#type-row_base.Commit" class="anchor"></a><code><span>| </span></code><code><span>`Commit <span class="keyword">of</span> <span><span class="type-var">'pack_stats</span> <a href="#type-commit_base">commit_base</a></span></span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-row_base_t"><a href="#val-row_base_t" class="anchor"></a><code><span><span class="keyword">val</span> row_base_t : 
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Repr</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ <span>`Add of int32</span>
  <span><span>| `Checkout</span> of int32</span>
  <span><span>| `Commit</span> of <span><span class="type-var">'a</span> <a href="#type-commit_base">commit_base</a></span></span>
  <span><span>| `Copy</span> of int32</span>
  <span><span>| `Find</span> of int32</span>
  <span><span>| `Mem</span> of int32</span>
  <span><span>| `Mem_tree</span> of int32</span>
  <span><span>| `Remove</span> of int32</span> ]</span>
    <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-row"><a href="#type-row" class="anchor"></a><code><span><span class="keyword">type</span> row</span><span> = <span><a href="#type-pack">pack</a> <a href="#type-row_base">row_base</a></span></span></code></div><div class="spec-doc"><p>Stats gathered while running an operation.</p><p>Operation durations</p><p>For each operation we record its wall time length using a <code>float32</code>, a <code>float16</code> would be suitable too (it has &gt;3 digits of precision).</p><p>Time and disk performance considerations</p><p>On commit we record a lot of things, thankfuly the frequency is low: ~1/600. 599 small operations weigh ~3600 bytes, 1 commit weighs ~300 bytes. The trace reaches 1GB after ~250k commits.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-row_t"><a href="#val-row_t" class="anchor"></a><code><span><span class="keyword">val</span> row_t : 
  <span><span>[ <span>`Add of int32</span>
  <span><span>| `Checkout</span> of int32</span>
  <span><span>| `Commit</span> of <span><a href="#type-pack">pack</a> <a href="#type-commit_base">commit_base</a></span></span>
  <span><span>| `Copy</span> of int32</span>
  <span><span>| `Find</span> of int32</span>
  <span><span>| `Mem</span> of int32</span>
  <span><span>| `Mem_tree</span> of int32</span>
  <span><span>| `Remove</span> of int32</span> ]</span>
    <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-setup_play"><a href="#type-setup_play" class="anchor"></a><code><span><span class="keyword">type</span> setup_play</span><span> = unit</span></code></div><div class="spec-doc"><p>Informations gathered from the tezos node.</p><p>Noting so far. Any ideas?</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-setup_play_t"><a href="#val-setup_play_t" class="anchor"></a><code><span><span class="keyword">val</span> setup_play_t : <span>unit <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-setup_replay"><a href="#type-setup_replay" class="anchor"></a><code><span><span class="keyword">type</span> setup_replay</span><span> = </span><span>{</span></code><ol><li id="type-setup_replay.path_conversion" class="def record field anchored"><a href="#type-setup_replay.path_conversion" class="anchor"></a><code><span>path_conversion : <span>[ `None <span>| `V1</span> <span>| `V0_and_v1</span> <span>| `V0</span> ]</span>;</span></code></li><li id="type-setup_replay.artefacts_dir" class="def record field anchored"><a href="#type-setup_replay.artefacts_dir" class="anchor"></a><code><span>artefacts_dir : string;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Informations gathered from the tree.exe parameters.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-setup_replay_t"><a href="#val-setup_replay_t" class="anchor"></a><code><span><span class="keyword">val</span> setup_replay_t : <span><a href="#type-setup_replay">setup_replay</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-config"><a href="#type-config" class="anchor"></a><code><span><span class="keyword">type</span> config</span><span> = </span><span>{</span></code><ol><li id="type-config.inode_config" class="def record field anchored"><a href="#type-config.inode_config" class="anchor"></a><code><span>inode_config : int * int * int;</span></code></li><li id="type-config.store_type" class="def record field anchored"><a href="#type-config.store_type" class="anchor"></a><code><span>store_type : <span>[ `Pack <span>| `Pack_layered</span> <span>| `Pack_mem</span> ]</span>;</span></code></li><li id="type-config.setup" class="def record field anchored"><a href="#type-config.setup" class="anchor"></a><code><span>setup : <span>[ <span>`Play of <a href="#type-setup_play">setup_play</a></span> <span><span>| `Replay</span> of <a href="#type-setup_replay">setup_replay</a></span> ]</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-config_t"><a href="#val-config_t" class="anchor"></a><code><span><span class="keyword">val</span> config_t : <span><a href="#type-config">config</a> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-header_base"><a href="#type-header_base" class="anchor"></a><code><span><span class="keyword">type</span> <span>'pack_stats header_base</span></span><span> = </span><span>{</span></code><ol><li id="type-header_base.config" class="def record field anchored"><a href="#type-header_base.config" class="anchor"></a><code><span>config : <a href="#type-config">config</a>;</span></code></li><li id="type-header_base.hostname" class="def record field anchored"><a href="#type-header_base.hostname" class="anchor"></a><code><span>hostname : string;</span></code></li><li id="type-header_base.timeofday" class="def record field anchored"><a href="#type-header_base.timeofday" class="anchor"></a><code><span>timeofday : float;</span></code></li><li id="type-header_base.word_size" class="def record field anchored"><a href="#type-header_base.word_size" class="anchor"></a><code><span>word_size : int;</span></code></li><li id="type-header_base.initial_stats" class="def record field anchored"><a href="#type-header_base.initial_stats" class="anchor"></a><code><span>initial_stats : <span><span class="type-var">'pack_stats</span> <a href="#type-bag_of_stats_base">bag_of_stats_base</a></span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-header_base_t"><a href="#val-header_base_t" class="anchor"></a><code><span><span class="keyword">val</span> header_base_t : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Repr</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-header_base">header_base</a></span> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-header"><a href="#type-header" class="anchor"></a><code><span><span class="keyword">type</span> header</span><span> = <span><a href="#type-pack">pack</a> <a href="#type-header_base">header_base</a></span></span></code></div><div class="spec-doc"><p>File header.</p><p>Timestamps</p><p><code>stats.timestamp_wall</code> and <code>stats.timestamp_cpu</code> are the starting points of the trace, they are to be substracted from their counterpart in <code>commit</code> to compute time spans.</p><p><code>timeofday</code> is the date and time at which the stats started to be accumulated.</p><p><code>stats.timestamp_wall</code> may originate from <code>Mtime_clock.now</code>.</p><p><code>stats.timestamp_cpu</code> may originate from <code>Sys.time</code>.</p><p>It would be great to be able to record the library/sources versions.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-header_t"><a href="#val-header_t" class="anchor"></a><code><span><span class="keyword">val</span> header_t : <span><span><a href="#type-pack">pack</a> <a href="#type-header_base">header_base</a></span> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-commit"><a href="#type-commit" class="anchor"></a><code><span><span class="keyword">type</span> commit</span><span> = <span><a href="#type-pack">pack</a> <a href="#type-commit_base">commit_base</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-commit_t"><a href="#val-commit_t" class="anchor"></a><code><span><span class="keyword">val</span> commit_t : <span><span><a href="#type-pack">pack</a> <a href="#type-commit_base">commit_base</a></span> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-bag_of_stats"><a href="#type-bag_of_stats" class="anchor"></a><code><span><span class="keyword">type</span> bag_of_stats</span><span> = <span><a href="#type-pack">pack</a> <a href="#type-bag_of_stats_base">bag_of_stats_base</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bag_of_stats_t"><a href="#val-bag_of_stats_t" class="anchor"></a><code><span><span class="keyword">val</span> bag_of_stats_t : <span><span><a href="#type-pack">pack</a> <a href="#type-bag_of_stats_base">bag_of_stats_base</a></span> <span class="xref-unresolved">Repr</span>.t</span></span></code></div></div></div></body></html>